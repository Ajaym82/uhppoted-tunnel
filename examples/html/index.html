<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <title>uhppoted-tunnel</title>
    <link rel="manifest"   href="/manifest.json">
    <link rel="icon"       href="/images/favicon.svg">
    <link rel="stylesheet" href="/css/tunnel.css" type="text/css">
    <meta charset="UTF-8">
  </head>
  <body> 
    <div id="content">
      <header>
        <img id="logo" src="/images/logo.png" />
        <h1>UDP Tunnel</h1>
        <div>
          <button onclick="onClear(event)">clear</button>
        </div>
      </header>
    
      <main>
        <div id="list" class="panel">
          <ul>
            <li onclick="onSelect('get-all-controllers')">get-all-controllers</li>
            <li onclick="onSelect('get-controller')">get-controller</li>
            <li onclick="onSelect('set-IP')">set-IP</li>
            <li onclick="onSelect('get-listener')">get-listener</li>
            <li onclick="onSelect('set-listener')">set-listener</li>
            <li onclick="onSelect('get-time')">get-time</li>
            <li onclick="onSelect('set-time')">set-time</li>
            <li onclick="onSelect('get-door-control')">get-door-control</li>
            <li onclick="onSelect('set-door-control')">set-door-control</li>
            <li onclick="onSelect('open-door')">open-door</li>
            <li onclick="onSelect('get-status')">get-status</li>
            <li onclick="onSelect('get-cards')">get-cards</li>
            <li onclick="onSelect('get-card')">get-card</li>
            <li onclick="onSelect('get-card-by-index')">get-card-by-index</li>
            <li onclick="onSelect('put-card')">put-card</li>
            <li onclick="onSelect('delete-card')">delete-card</li>
            <li onclick="onSelect('delete-all-cards')">delete-all-cards</li>
            <li onclick="onSelect('get-event')">get-event</li>
            <li onclick="onSelect('get-event-index')">get-event-index</li>
            <li onclick="onSelect('set-event-index')">set-event-index</li>
            <li onclick="onSelect('record-special-events')">record-special-events</li>
          </ul>
        </div>

        <div id="command" class="panel">
          <div class="executor">
            <input id="cmd" type="text" readonly />
            <button id="execute" onclick="onExecute(event)">execute</button>              
          </div>

          <div class="section controller">
            <div class="label">controller</div>
            <input id="controller" class="parameter" type="number" min="1" max="499999999" placeholder="device ID" data-tag="device.id" />
          </div>

          <div class="section IPv4">
            <div class="label">IPv4 configuration</div>
            <input id="ip-address" class="parameter" type="text" placeholder="IPv4 address"         data-tag="IP.address" />
            <input id="subnet"     class="parameter" type="text" placeholder="IPv4 subnet mask"     data-tag="IP.netmask" />
            <input id="gateway"    class="parameter" type="text" placeholder="IPv4 gateway address" data-tag="IP.gateway" />
          </div>

          <div class="section listener">
            <div class="label">listener</div>
            <input id="listener" class="parameter" type="text" placeholder="IPv4 address" data-tag="listener" />
          </div>
          
          <div class="section datetime">
            <div class="label">date/time</div>
            <input id="datetime" class="parameter" type="datetime-local" placeholder="" value="" />
          </div>

          <div class="section doors">
            <div class="label">door</div>
              <input id="door" class="parameter" type="number" min="1" max="4" placeholder="door" data-tag="door.id" />
              <label class="parameter">
                mode
                <input id="mode" type="number" min="1" max="3" data-tag="door.mode" placeholder="door control mode" value="3"/>
              </label>
              <label class="parameter">
                delay
                <input id="delay" type="number" min="1" max="60" data-tag="door.delay" placeholder="door delay" value="5" />
              </label>
          </div>

          <div class="section cards">
            <div class="label">card</div>
            <input id="card-number"     class="parameter" type="number" min="1" placeholder="card number" data-tag="card.number" />
            <input id="card-index"      class="parameter" type="number" min="1" placeholder="card index" data-tag="card.index" />
            <input id="card-start-date" class="parameter" type="date" placeholder="card start date" data-tag="card.start-date" />
            <input id="card-end-date"   class="parameter" type="date" placeholder="card end date" data-tag="card.end-date" />
            <input id="card-door-1"     class="parameter" type="number" min="0" max="254" placeholder="door 1 access" data-tag="card.door.1" />
            <input id="card-door-2"     class="parameter" type="number" min="0" max="254" placeholder="door 2 access" data-tag="card.door.2" />
            <input id="card-door-3"     class="parameter" type="number" min="0" max="254" placeholder="door 3 access" data-tag="card.door.3" />
            <input id="card-door-4"     class="parameter" type="number" min="0" max="254" placeholder="door 4 access" data-tag="card.door.4" />
          </div>

          <div class="section events">
            <div class="label">event</div>
            <input id="event-index" class="parameter" type="number" min="1" placeholder="event index" data-tag="event.index" />
            <label class="parameter">
              Record special events
              <input id="record-special-events" type="checkbox" data-tag="event.record-special-events" checked />
            </label>
          </div>

        </div>

        <div id="response" class="panel">
          <textarea></textarea>
        </div>

        <fieldset id="request" class="panel">
          <legend>Request</legend>
          <textarea></textarea>
        </fieldset>

        <fieldset id="reply" class="panel">
          <legend>Reply</legend>
          <textarea></textarea>
        </fieldset>
      </main>
    
      <footer>
        <p id="message"></p>
      </footer>
    </div>
  </body>

  <script type="module">
    import { 
      initialise,
      exec, 
      clear,
    } from './javascript/main.js'

    window.exec = exec
    window.clear = clear

    window.select = function(cmd) {
      const c = document.querySelector('input#cmd')
      const x = document.querySelector('button#execute')

      if (c) {
        c.value = cmd
        x.dataset.command = cmd
      }
    }

    initialise()

  </script>

  <script>
    function onSelect(cmd) {
      select(cmd)
    }

    function onExecute(event) {
      const command = event.target.dataset.command

      if (command) {
        exec(command)        
      }
    }

    function onCommand(cmd) {
      exec(cmd)
    }

    function onClear(event) {
      clear()
    }
  </script>

</html>